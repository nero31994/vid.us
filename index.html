<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Movie & TV Explorer</title>

  <!-- ✅ Preload CSS -->
  <link rel="preload" href="https://vid-us.vercel.app/style.css" as="style"/>
  <link rel="stylesheet" href="https://vid-us.vercel.app/style.css"/>

  <!-- ✅ Font Awesome -->
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" as="style"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" media="all"/>

  <style>
    body {
      margin: 0;
      display: flex;
      height: 100vh;
      background: #000;
      color: #fff;
      font-family: Arial, sans-serif;
    }

    img.logo {width: 140px; height: auto;}
    .intro-screen img {width: 220px; height: auto;}
    .intro-screen.fade-out {opacity: 0; transition: opacity 1s ease;}
    .intro-screen.hidden {display: none;}

    /* ✅ Sidebar */
    .sidebar {
      width: 70px;
      background: #111;
      display: flex;
      flex-direction: column;
      padding: 10px 0;
      border-right: 1px solid #222;
      transition: width 0.3s ease;
      overflow: hidden;
      position: relative;
    }

    .sidebar.expanded {
      width: 220px;
    }

    /* ✅ Toggle button */
    .toggle-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 12px;
      font-size: 1.4rem;
      cursor: pointer;
      color: #fff;
      border: none;
      background: none;
      margin-bottom: 20px;
    }

    /* ✅ Controls */
    .controls {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 12px;
      padding: 0 8px;
    }

    .controls button {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 10px;
      padding: 10px;
      border-radius: 6px;
      background: none;
      border: none;
      color: #fff;
      cursor: pointer;
      font-size: 1.1rem;
      width: 100%;
    }

    .controls button i {
      font-size: 1.4rem;
      min-width: 24px;
      text-align: center;
    }

    .controls button span {
      opacity: 0;
      white-space: nowrap;
      transition: opacity 0.3s ease;
    }

    .sidebar.expanded .controls button span {
      opacity: 1;
    }

    /* ✅ Search */
    .search-container {
      display: flex;
      align-items: center;
      padding: 10px 8px;
    }

    .search-container input {
      flex: 1;
      padding: 8px;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #444;
      background: #111;
      color: #fff;
      margin-left: 10px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .sidebar.expanded .search-container input {
      opacity: 1;
      pointer-events: auto;
    }

    .search-container input:focus {
      border-color: #00adee;
      box-shadow: 0 0 6px #00adee;
    }

    /* ✅ Content */
    main {
      flex: 1;
      overflow-y: auto;
    }

    .movie-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 15px;
      padding: 15px;
    }

    /* ✅ Video container fullscreen */
    #videoContainer {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: #000;
      z-index: 1000;
    }

    #videoContainer button {
      font-size: 2rem;
      position: absolute;
      top: 10px;
      right: 10px;
      background: none;
      border: none;
      color: #fff;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- ✅ Intro -->
  <div id="intro-screen" class="intro-screen">
    <img src="https://variety.com/wp-content/uploads/2019/02/netflix_newlogoanimation.gif" alt="Intro Animation" loading="lazy"/>
  </div>

  <!-- ✅ Sidebar -->
  <aside class="sidebar" id="sidebar">
    <button class="toggle-btn" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
    <div class="controls">
      <button onclick="switchMode('movie')" title="Movies"><i class="fas fa-film"></i><span>Movies</span></button>
      <button onclick="switchMode('tv')" title="TV Series"><i class="fas fa-tv"></i><span>TV Series</span></button>
      <button onclick="switchMode('anime')" title="Anime"><i class="fas fa-dragon"></i><span>Anime</span></button>
    </div>
    <div class="search-container">
      <i class="fas fa-search"></i>
      <input id="search" type="text" placeholder="Search..." oninput="debounceSearch()"/>
    </div>
  </aside>

  <!-- ✅ Content -->
  <main>
    <div id="movies" class="movie-grid" tabindex="0"></div>
    <div id="sentinel"></div>
    <div id="loading">Loading...</div>
    <div id="error"></div>
  </main>

  <!-- ✅ Player -->
  <div id="videoContainer">
    <button onclick="closeIframe()">×</button>
    <iframe id="videoFrame" allow="autoplay; fullscreen" allowfullscreen style="width:100%;height:100%;border:none"></iframe>
  </div>

  <!-- ✅ Scripts -->
  <script>
    // ✅ Intro screen fade
    window.addEventListener("load",()=>{
      const intro=document.querySelector(".intro-screen");
      if(intro){
        setTimeout(()=>{
          intro.classList.add("fade-out");
          setTimeout(()=>intro.classList.add("hidden"),1000);
        },1500);
      }
    });

    // ✅ Sidebar toggle
    function toggleSidebar(){
      document.getElementById("sidebar").classList.toggle("expanded");
    }

    // ✅ Debounced search
    let debounceTimeout;
    function debounceSearch(){
      clearTimeout(debounceTimeout);
      debounceTimeout=setTimeout(()=>{
        const val=document.getElementById("search").value.trim();
        val?searchMovies(val):clearMovies();
      },300);
    }

    // ✅ Dummy functions
    function switchMode(m){console.log("Switched to:",m)}
    function searchMovies(q){console.log("Searching:",q)}
    function clearMovies(){document.getElementById("movies").innerHTML=""}

    // ✅ Video player
    function openIframe(url){
      const vc=document.getElementById("videoContainer"), vf=document.getElementById("videoFrame");
      vf.src=url; vc.style.display="block";
    }
    function closeIframe(){
      const vc=document.getElementById("videoContainer"), vf=document.getElementById("videoFrame");
      vf.src=""; vc.style.display="none";
    }

    // ✅ Remote navigation
    document.addEventListener("keydown",(e)=>{
      const focusable=document.querySelectorAll("button, .movie-item, input");
      let index=[...focusable].indexOf(document.activeElement);

      switch(e.key){
        case "ArrowRight": if(index+1<focusable.length) focusable[index+1].focus(); break;
        case "ArrowLeft": if(index-1>=0) focusable[index-1].focus(); break;
        case "ArrowDown": if(index+3<focusable.length) focusable[index+3].focus(); break;
        case "ArrowUp": if(index-3>=0) focusable[index-3].focus(); break;
        case "Enter": document.activeElement.click?.(); break;
        case "Backspace": closeIframe(); break;
        case "Escape": document.getElementById("sidebar").classList.remove("expanded"); break;
      }
    });
  </script>

  <!-- ✅ External scripts -->
  <script src="https://vid-us.vercel.app/script.js" defer></script>
  <script src="https://vid-us.vercel.app/remote.js" defer></script>
  <script src="https://vid-us.vercel.app/modal.js" defer></script>
</body>
</html>
